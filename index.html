<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>validate demo</title>
    <style>
      body{
        font-size: 14px;
        clear: both;
        padding-left: 5px;
      }
      p{
        display: block;
        margin: auto;
      }
      input{
        width: 300px;
      }
      .validate{
        margin-top: 15px;
        height: 20px;
        /*display: block;*/
      }
      .add-new{
        margin-top: 30px;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <input class="validate" validate-rule="int|len:{min:3,max:5}" validate-success="输入正确" validate-fail="请输入数字" placeholder="输入整数">
      <input class="validate" validate-rule="test:{a:1,b:2}" validate-success="测试正确" validate-fail="测试失败" placeholder="自定义验证">
      <select name="test-select" class="validate" validate-rule="in:['a','b']">
        <option value="a">a</option>
        <option value="b">b</option>
        <option value="c">c</option>
      </select>
      <div><input type="radio" class="validate" name="radio" value="radio1" validate-group="group1"/> radio1</div>
      <div><input type="radio" class="validate" name="radio" value="radio2" validate-group="group1" validate-rule="in:['radio2','radio3']"/> radio2</div>
      <br/>

      <input type="checkbox" class="validate" name="checkbox1" validate-group="group2" value="checkbox1"/>checkbox1<br />
      <input type="checkbox" class="validate" name="checkbox2" validate-group="group2" value="checkbox2" validate-rule="haha"/>checkbox1<br />

      <div class="add-new" id="add-new">
      <hr>
        <form id="rule-form">
          <label for="rule">验证规则:</label>
          <input type="text" name="rule" id="rule" validate-rule="alpha" placeholder="采用'|'分割不同规则" /><br>
          <label for="trigger">触发条件:</label>
          <input type="text" name="trigger" id="trigger" validate-rule="alpha|in:['change', 'keypress', 'keydown', 'keyup', 'blur']" 
          placeholder="one of 'change', 'keypress', 'keydown', 'keyup', 'blur' "/><br>
          <label for="success">验证通过提示:</label>
          <input type="text" name="success" id="success" validate-rule="alpha"/><br>
          <label for="fail">验证失败提示:</label>
          <input type="text" name="fail" id="fail" validate-rule="alpha"/><br>
        </form>
      <button id="addButton">新增一个测试</button>
      <button id="validate-all">测试全部</button>
      </div>
    </div>
    <!-- built files will be auto injected -->
  </body>
  <script>
    window.onload = function() {

      document.getElementById('addButton').addEventListener('click', function() {
        let rule = document.getElementById('rule').value;
        let trigger = document.getElementById('trigger').value || 'change';
        let successInfo = document.getElementById('success').value;
        let failInfo = document.getElementById('fail').value;

        let newInput = document.createElement("input");
        newInput.className = 'validate';
        rule && newInput.setAttribute('validate-rule', rule);
        newInput.setAttribute('placeholder', rule || '不能为空')
        newInput.setAttribute('validate-trigger', trigger);
        successInfo && newInput.setAttribute('validate-success', successInfo);
        failInfo && newInput.setAttribute('validate-fail', failInfo);
        document.getElementById('app').insertBefore(newInput,document.getElementById('add-new'));
      });

      document.getElementById('validate-all').addEventListener('click', function(){
        validate.validateAll()
      })
      // attachEvent();
      validate.autoValidate();
      validate.addRule('test', function(value, ruleParams){
        console.log(value,ruleParams);
        return false
      })
    }
  </script>
</html>
